!function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=n(1),a=r(o);!function(n,r,o){function a(){var e=new c;l.watch(e),l.dispose(e)}function u(e){if(e){for(var t=0;1e3>t;t++)a();u(--e)}}function s(){var e=arguments.length<=0||void 0===arguments[0]?5:arguments[0],t=performance.now();u(e);var n=performance.now();console.log("Perf for "+e+": "+(n-t)+" milliseconds.")}var l=new r;o?o[n]=l:("undefined"!=typeof e&&e.exports&&(t=e.exports=l),t[n]=l);var c=function f(){var e=this;i(this,f),this.id=1,this.name="Tom",this.surname="Jarvis",this.fullName=function(){return e.name+" "+e.surname},this.array=[1,2,3,4,5,6,7,8]};o.perf=s}("baxter",a["default"],window)},function(e,t,n){function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(2),u=r(a),s=n(3),l=r(s),c=n(4),f=r(c),v=function(){function e(){var t=this;i(this,e);var n=1;this.callstack=new Map,this.variables=new Map,this.eventStream=new u["default"](this),this.utils={createObjectUID:function(e){var t=n++;return Object.defineProperty(e,"__uid__",{enumerable:!1,value:t}),t},getUIDByObject:function(e){return e.__uid__?e.__uid__:t.utils.createObjectUID(e)},createKeyUID:function(e,n){return t.utils.getUIDByObject(e)+":"+n}},this.subscribeEvent("will-change",this.debounce(function(){return t.postEvent("will-change-all")},20))}return o(e,[{key:"debounce",value:function(e,t){var n;return function(){var r=function(){e(),n=null};clearTimeout(n),n=setTimeout(r,t)}}},{key:"dispose",value:function(e,t){if(!t){var n=!0,r=!1,i=void 0;try{for(var o,a=Object.keys(e)[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var u=o.value,s=this.utils.createKeyUID(e,u),l=this.variables.get(s);if(l){var c=!0,f=!1,v=void 0;try{for(var h,d=l[Symbol.iterator]();!(c=(h=d.next()).done);c=!0){var y=h.value;y.dispose(),delete e[u]}}catch(p){f=!0,v=p}finally{try{!c&&d["return"]&&d["return"]()}finally{if(f)throw v}}this.variables["delete"](s)}}}catch(p){r=!0,i=p}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw i}}return!0}var s=this.utils.createKeyUID(e,t),l=this.variables.get(s);if(!l)return!1;var w=!0,b=!1,g=void 0;try{for(var m,k=l[Symbol.iterator]();!(w=(m=k.next()).done);w=!0){var y=m.value;y.dispose(),delete e[t]}}catch(p){b=!0,g=p}finally{try{!w&&k["return"]&&k["return"]()}finally{if(b)throw g}}this.variables["delete"](s)}},{key:"subscribeEvent",value:function(e,t){var n=this;return this.eventStream.on(e,t),{dispose:function(){return n.eventStream.off(e,t)}}}},{key:"postEvent",value:function(e,t){this.eventStream.post(e,t)}},{key:"subscribe",value:function(e,t,n){var r=arguments.length<=3||void 0===arguments[3]?"update":arguments[3];if(!e||!t||!n)throw new l["default"]("can't subscribe variable without owner, key or callback function.");var i=this.utils.createKeyUID(e,t),o=["will-change","update"],a=-1!==o.indexOf(r)&&r,u=function(e){e.uid===i&&n(e.value,e.oldValue)};if(!a)throw new l["default"]("subscribe: listening "+r+" event is not accepted.");return this.subscribeEvent(a,u)}},{key:"resolve",value:function(e){var t=new Set,n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var u=o.value;t.add(this.callstack.get(u))}}catch(s){r=!0,i=s}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw i}}return Promise.all(t)}},{key:"getDependencies",value:function(e,t){var n=this.subscribeEvent("get",t),r=e();return n.dispose(),new Promise(function(e){e(r)}).then(function(e){return e})}},{key:"addToStack",value:function(e,t,n){var r=this,i=this.utils.createKeyUID(e,t),o=function(e){r.callstack["delete"](i),r.callstack.size||r.postEvent("change-complete"),e()};this.postEvent("will-change",{uid:i,owner:e,key:t}),this.callstack.set(i,new Promise(function(e){r.eventStream.once("will-change-all",function(){var t=n();t instanceof Promise?t.then(function(){o(e)}):o(e)})}))}},{key:"observable",value:function(e,t,n){var r=this,i=n,o=this.utils.createKeyUID(e,t);return Object.defineProperty(e,t,{configurable:!0,set:function(n){return n===i?!1:void r.addToStack(e,t,function(){var a=i;i=n,r.eventStream.post("update",{uid:o,owner:e,key:t,value:i,oldValue:a})})},get:function(){return r.eventStream.post("get",{uid:o,owner:e,key:t,value:i}),i}}),i}},{key:"computed",value:function(e,t,n,r){var i=this,o=void 0,a=void 0,u=!1,s=this.utils.createKeyUID(e,t),c=!1,f=new Set,v=new Set;this.variables.set(s,v),Object.defineProperty(e,t,{configurable:!0,get:function(){return i.eventStream.post("get",{uid:s,owner:e,key:t,value:o}),o},set:function(n){if(!c)throw new l["default"]("you can't set value to computed");return c=!1,o=n,o===a?!1:void i.eventStream.post("update",{uid:s,owner:e,key:t,value:o,oldValue:a})}});var h=function(r){if(r.uid===s)throw new l["default"]("Circular dependencies detected on "+t+" value.");f.add(i.utils.createKeyUID(r.owner,r.key));var h=i.subscribe(r.owner,r.key,function(){return u?!1:(i.addToStack(e,t,function(){return i.resolve(f).then(function(){return a=o,n.call(e)}).then(function(n){u=!1,c=!0,e[t]=n})}),void(u=!0))},"will-change");v.add(h)};if(Symbol.iterator in Object(r)){var d=!0,y=!1,p=void 0;try{for(var w,b=r[Symbol.iterator]();!(d=(w=b.next()).done);d=!0){var g=w.value;h(g)}}catch(m){y=!0,p=m}finally{try{!d&&b["return"]&&b["return"]()}finally{if(y)throw p}}}return this.getDependencies(n,h).then(function(n){i.addToStack(e,t,function(){return i.resolve(f).then(function(){c=!0,e[t]=n})})}),o}},{key:"array",value:function(e,t,n){var r=this,i=this.utils.createKeyUID(e,t),o=new f["default"](i,e,t,this.eventStream,n);return e[t]=o,Object.defineProperty(e,t,{configurable:!0,get:function(){return o},set:function(n){return r.eventStream.post("update",{uid:i,owner:e,key:t,value:n}),n}}),o}},{key:"watch",value:function(e){for(var t in e)if(e.hasOwnProperty(t)){var n=e[t];"function"==typeof n?this.computed(e,t,n):this.observable(e,t,n)}return e}}]),e}();t["default"]=v,e.exports=t["default"]},function(e,t){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t){n(this,e),this.channels={},this.context=t||this}return r(e,[{key:"getEvent",value:function(e){return e in this.channels?this.channels[e]:this.channels[e]=new Set}},{key:"on",value:function(e,t){if(!e||!t)throw new Error("Can't init event listener: no parameters given");this.getEvent(e).add(t)}},{key:"once",value:function(e,t){function n(i){return r.off(e,n),t(i)}if(!e||!t)throw new Error("Can't init event listener: no parameters given");var r=this;this.getEvent(e).add(n)}},{key:"off",value:function(e,t){if(!e)throw new Error("Can't remove event listener: no event");if(!t)return delete this.channels[e];var n=this.channels[e];n["delete"](t),n.size||delete this.channels[e]}},{key:"post",value:function(e,t){if(!e)throw new Error("Can't post undefined event");if(!(e in this.channels))return!1;var n=!0,r=!1,i=void 0;try{for(var o,a=this.channels[e][Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var u=o.value;u.call(this.context,t)}}catch(s){r=!0,i=s}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw i}}}}]),e}();t["default"]=i,e.exports=t["default"]},function(e,t){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function i(e){return n(this,i),new Error("[Twin.js]: "+e)};t["default"]=r,e.exports=t["default"]},function(e,t){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e,t,n){for(var r=!0;r;){var i=e,o=t,a=n;u=l=s=void 0,r=!1,null===i&&(i=Function.prototype);var u=Object.getOwnPropertyDescriptor(i,o);if(void 0!==u){if("value"in u)return u.value;var s=u.get;return void 0===s?void 0:s.call(a)}var l=Object.getPrototypeOf(i);if(null===l)return void 0;e=l,t=o,n=a,r=!0}},a=function(e){function t(e,r,i,a,u){n(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),Object.assign(this,u),this.length=u.length,this.eventStream=a,this.owner=r,this.key=i,this.uid=e}return r(t,e),i(t,[{key:"push",value:function(e){var n=o(Object.getPrototypeOf(t.prototype),"push",this).call(this,e);return this.eventStream.post("update",{uid:this.uid,owner:this.owner,key:this.key,value:this,type:"push",changed:this[n]}),n}},{key:"shift",value:function(){var e=o(Object.getPrototypeOf(t.prototype),"shift",this).call(this);return this.eventStream.post("update",{uid:this.uid,owner:this.owner,key:this.key,value:this,type:"shift",changed:e}),e}},{key:"pop",value:function(){var e=o(Object.getPrototypeOf(t.prototype),"pop",this).call(this);return this.eventStream.post("update",{uid:this.uid,owner:this.owner,key:this.key,value:this,type:"pop",changed:e}),e}},{key:"unshift",value:function(){for(var e=arguments.length,n=Array(e),r=0;e>r;r++)n[r]=arguments[r];var i=o(Object.getPrototypeOf(t.prototype),"unshift",this).apply(this,n);return this.eventStream.post("update",{uid:this.uid,owner:this.owner,key:this.key,value:this,type:"unshift",changed:n}),i}},{key:"reverse",value:function(){var e=o(Object.getPrototypeOf(t.prototype),"reverse",this).call(this);return this.eventStream.post("update",{uid:this.uid,owner:this.owner,key:this.key,value:this,type:"reverse",changed:e}),e}},{key:"sort",value:function(e){var n=o(Object.getPrototypeOf(t.prototype),"sort",this).call(this,e);return this.eventStream.post("update",{uid:this.uid,owner:this.owner,key:this.key,value:this,type:"sort",changed:n}),n}},{key:"splice",value:function(){for(var e=n.length,n=Array(e),r=0;e>r;r++)n[r]=n[r];var i=o(Object.getPrototypeOf(t.prototype),"splice",this).apply(this,n);return this.eventStream.post("update",{uid:this.uid,owner:this.owner,key:this.key,value:this,type:"splice",changed:i}),i}}]),t}(Array);t["default"]=a,e.exports=t["default"]}]);